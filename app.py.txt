import streamlit as st
import pandas as pd
import pickle
import numpy as np

# Load the trained model
with open('logistic_regression_titanic.pkl', 'rb') as f:
    model = pickle.load(f)

st.title("Titanic Survival Prediction App")
st.write("Enter passenger details below to predict survival:")

# --- User Inputs ---
pclass = st.selectbox("Passenger Class (1 = 1st, 2 = 2nd, 3 = 3rd):", [1, 2, 3])
sex = st.selectbox("Sex:", ["Male", "Female"])
age = st.number_input("Age:", min_value=0, max_value=100, value=30)
sibsp = st.number_input("Number of Siblings/Spouses aboard:", min_value=0, max_value=10, value=0)
parch = st.number_input("Number of Parents/Children aboard:", min_value=0, max_value=10, value=0)
fare = st.number_input("Fare:", min_value=0.0, max_value=1000.0, value=32.0)
embarked = st.selectbox("Port of Embarkation (0=Cherbourg, 1=Queenstown, 2=Southampton):", [0, 1, 2])

# Encode sex
sex_encoded = 1 if sex == "Male" else 0

# Create DataFrame for prediction
input_data = pd.DataFrame({
    'Pclass': [pclass],
    'Sex': [sex_encoded],
    'Age': [age],
    'SibSp': [sibsp],
    'Parch': [parch],
    'Fare': [fare],
    'Embarked': [embarked]
})

# --- Prediction ---
if st.button("Predict Survival"):
    prediction = model.predict(input_data)[0]
    probability = model.predict_proba(input_data)[0][1]
    
    if prediction == 1:
        st.success(f"The passenger **survived** with probability {probability:.2f}")
    else:
        st.error(f"The passenger **did not survive** with probability {1-probability:.2f}")